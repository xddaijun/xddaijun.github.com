---
layout: default
title: Pinyin to Character
---
h1. Pinyin to Character

<p>用户输入拼音对拼音进行识别，一向是输入法来做的事情。在这里调用QQ的云端输入法来对输入的拼音进行识别，从而具备很高的匹配率。</p>
<p>代码如下，详见 &nbsp;<a href="https://github.com/xddaijun/somecode/blob/master/pycharacter/getwords.py">https://github.com/xddaijun/somecode/blob/master/pycharacter/getwords.py</a></p>
     <div class="source" style="font-family: '[object HTMLOptionElement]', 'Courier New'; color: rgb(0, 0, 0); "><span style="color: rgb(0, 136, 0); font-style: italic; ">01 </span> <span style="color: rgb(0, 136, 0); font-style: italic; "># -*- coding: utf-8 -*-</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">02 </span> <span style="color: rgb(0, 0, 255); ">&quot;&quot;"</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">03 </span> <span style="color: rgb(0, 0, 255); ">Created on Sat Jun 25 16:37:12 2011</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">04 </span> <br><span style="color: rgb(248, 16, 176); ">05 </span> <span style="color: rgb(0, 0, 255); ">@author: mark</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">06 </span> <span style="color: rgb(0, 0, 255); ">&quot;&quot;"</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">07 </span> <br><span style="color: rgb(0, 136, 0); font-style: italic; ">08 </span> <span style="color: rgb(0, 0, 0); ">from</span> <span style="color: rgb(0, 0, 0); ">urllib</span> <span style="color: rgb(0, 0, 0); ">import</span> <span style="color: rgb(0, 0, 0); ">urlopen</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">09 </span> <span style="color: rgb(0, 0, 0); ">import</span> <span style="color: rgb(0, 0, 0); ">json</span><br><span style="color: rgb(248, 16, 176); ">10 </span> <span style="color: rgb(0, 0, 0); ">import</span> <span style="color: rgb(0, 0, 0); ">time</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">11 </span> <span style="color: rgb(0, 0, 0); ">import</span> <span style="color: rgb(0, 0, 0); ">re</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">12 </span> <br><span style="color: rgb(0, 136, 0); font-style: italic; ">13 </span> <br><span style="color: rgb(0, 136, 0); font-style: italic; ">14 </span> <span style="color: rgb(0, 0, 128); font-weight: bold; ">def</span> <span style="color: rgb(0, 0, 0); ">getQQWords</span>(<span style="color: rgb(0, 0, 0); ">preword</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(0, 0, 0); ">pys</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(0, 0, 0); ">curNum</span><span style="color: rgb(0, 0, 0); ">):</span> <br><span style="color: rgb(248, 16, 176); ">15 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">global</span> <span style="color: rgb(0, 0, 0); ">wordsSet</span>&nbsp;&nbsp;&nbsp; <br><span style="color: rgb(0, 136, 0); font-style: italic; ">16 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">if</span>(<span style="color: rgb(0, 0, 0); ">len</span>(<span style="color: rgb(0, 0, 0); ">pys</span>)<span style="color: rgb(0, 0, 0); ">&lt;</span><span style="color: rgb(0, 0, 255); ">1</span> <span style="font-weight: bold; ">and</span> <span style="color: rgb(0, 0, 0); ">preword</span> <span style="font-weight: bold; ">not</span> <span style="font-weight: bold; ">in</span> <span style="color: rgb(0, 0, 0); ">wordsSet</span><span style="color: rgb(0, 0, 0); ">):</span>&nbsp;&nbsp;&nbsp;&nbsp; <br><span style="color: rgb(0, 136, 0); font-style: italic; ">17 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">wordsSet</span><span style="color: rgb(0, 0, 0); ">.</span><span style="color: rgb(0, 0, 0); ">append</span>(<span style="color: rgb(0, 0, 0); ">preword</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">18 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">return</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">19 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">if</span> <span style="color: rgb(0, 0, 0); ">curNum</span><span style="color: rgb(0, 0, 0); ">&gt;</span><span style="color: rgb(0, 0, 255); ">1</span><span style="color: rgb(0, 0, 0); ">:</span><br><span style="color: rgb(248, 16, 176); ">20 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">nextNum</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">curNum</span><span style="color: rgb(0, 0, 0); ">-</span><span style="color: rgb(0, 0, 255); ">1</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">21 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">else</span><span style="color: rgb(0, 0, 0); ">:</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">22 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">nextNum</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 255); ">1</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">23 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">pylen</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">len</span>(<span style="color: rgb(0, 0, 0); ">pys</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">24 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">sout</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">json</span><span style="color: rgb(0, 0, 0); ">.</span><span style="color: rgb(0, 0, 0); ">load</span>(<span style="color: rgb(0, 0, 0); ">urlopen</span>(<span style="color: rgb(0, 0, 255); ">&quot;http://ime.qq.com/fcgi-bin/getword?q=</span><span style="color: rgb(0, 0, 255); ">%s</span><span style="color: rgb(0, 0, 255); ">&quot;</span> <span style="color: rgb(0, 0, 0); ">%</span> <span style="color: rgb(0, 0, 0); ">pys</span>))<br><span style="color: rgb(248, 16, 176); ">25 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 255); ">0</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">26 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">while</span>(<span style="color: rgb(0, 0, 0); ">pylen</span><span style="color: rgb(0, 0, 0); ">&gt;=</span><span style="color: rgb(0, 0, 255); ">1</span> <span style="font-weight: bold; ">and</span> <span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">&lt;</span><span style="color: rgb(0, 0, 0); ">curNum</span><span style="color: rgb(0, 0, 0); ">):</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">27 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">getQQWords</span>(<span style="color: rgb(0, 0, 0); ">preword</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">sout</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 255); ">&#39;rs&#39;</span><span style="color: rgb(0, 0, 0); ">][</span><span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">],</span><span style="color: rgb(0, 0, 0); ">pys</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 0); ">int</span>(<span style="color: rgb(0, 0, 0); ">sout</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 255); ">&#39;rsn&#39;</span><span style="color: rgb(0, 0, 0); ">][</span><span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">]):],</span><span style="color: rgb(0, 0, 0); ">nextNum</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">28 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 255); ">1</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">29 </span> <br><span style="color: rgb(248, 16, 176); ">30 </span> <span style="color: rgb(0, 0, 128); font-weight: bold; ">def</span> <span style="color: rgb(0, 0, 0); ">parsePY</span>(<span style="color: rgb(0, 0, 0); ">inputStr</span><span style="color: rgb(0, 0, 0); ">):</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">31 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">global</span> <span style="color: rgb(0, 0, 0); ">wordsSet</span>&nbsp;&nbsp;&nbsp; <br><span style="color: rgb(0, 136, 0); font-style: italic; ">32 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">outwords</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">[]</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">33 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">match</span> <span style="color: rgb(0, 0, 0); ">=</span> <span style="color: rgb(0, 0, 0); ">re</span><span style="color: rgb(0, 0, 0); ">.</span><span style="color: rgb(0, 0, 0); ">search</span>(<span style="color: rgb(0, 0, 255); ">r&#39;^[a-zA-Z</span><span style="color: rgb(0, 0, 255); ">\&#39;</span><span style="color: rgb(0, 0, 255); ">\s]+$&#39;</span><span style="color: rgb(0, 0, 0); ">,</span> <span style="color: rgb(0, 0, 0); ">inputStr</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">34 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">if</span> <span style="color: rgb(0, 0, 0); ">match</span><span style="color: rgb(0, 0, 0); ">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br><span style="color: rgb(248, 16, 176); ">35 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">matches</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">re</span><span style="color: rgb(0, 0, 0); ">.</span><span style="color: rgb(0, 0, 0); ">split</span>(<span style="color: rgb(0, 0, 255); ">&quot;\s&quot;</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(0, 0, 0); ">inputStr</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">36 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 255); ">0</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">37 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">if</span> <span style="color: rgb(0, 0, 0); ">len</span>(<span style="color: rgb(0, 0, 0); ">matches</span>)<span style="color: rgb(0, 0, 0); ">&gt;</span><span style="color: rgb(0, 0, 255); ">1</span><span style="color: rgb(0, 0, 0); ">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br><span style="color: rgb(0, 136, 0); font-style: italic; ">38 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">outwords</span><span style="color: rgb(0, 0, 0); ">.</span><span style="color: rgb(0, 0, 0); ">append</span>(<span style="color: rgb(0, 0, 255); ">&quot;&quot;</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">39 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">while</span> <span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">&lt;</span><span style="color: rgb(0, 0, 0); ">len</span>(<span style="color: rgb(0, 0, 0); ">matches</span><span style="color: rgb(0, 0, 0); ">):</span><br><span style="color: rgb(248, 16, 176); ">40 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">wordsSet</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">[]</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">41 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">getQQWords</span>(<span style="color: rgb(0, 0, 255); ">&quot;&quot;</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(0, 0, 0); ">matches</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">],</span><span style="color: rgb(0, 0, 255); ">1</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">42 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">outwords</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 255); ">0</span><span style="color: rgb(0, 0, 0); ">]</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">outwords</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 255); ">0</span><span style="color: rgb(0, 0, 0); ">]</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">wordsSet</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 255); ">0</span><span style="color: rgb(0, 0, 0); ">]</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 255); ">&quot; &quot;</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">43 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 255); ">1</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">44 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">else</span><span style="color: rgb(0, 0, 0); ">:</span><br><span style="color: rgb(248, 16, 176); ">45 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">wordsSet</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">[]</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">46 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">getQQWords</span>(<span style="color: rgb(0, 0, 255); ">&quot;&quot;</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(0, 0, 0); ">matches</span><span style="color: rgb(0, 0, 0); ">[</span><span style="color: rgb(0, 0, 0); ">ix</span><span style="color: rgb(0, 0, 0); ">],</span><span style="color: rgb(0, 0, 255); ">3</span>)<br><span style="color: rgb(0, 136, 0); font-style: italic; ">47 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">outwords</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">wordsSet</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">48 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">return</span> <span style="color: rgb(0, 0, 0); ">outwords</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br><span style="color: rgb(0, 136, 0); font-style: italic; ">49 </span> <br><span style="color: rgb(248, 16, 176); ">50 </span> <span style="color: rgb(0, 0, 128); font-weight: bold; ">def</span> <span style="color: rgb(0, 0, 0); ">main</span><span style="color: rgb(0, 0, 0); ">():</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">51 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">for</span> <span style="color: rgb(0, 0, 0); ">w</span> <span style="font-weight: bold; ">in</span> <span style="color: rgb(0, 0, 0); ">parsePY</span>(<span style="color: rgb(0, 0, 255); ">&quot;woshiyigerxi&#39;anshi&quot;</span><span style="color: rgb(0, 0, 0); ">):</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">52 </span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">print</span> <span style="color: rgb(0, 0, 0); ">w</span><br><span style="color: rgb(0, 136, 0); font-style: italic; ">53 </span> <br><span style="color: rgb(0, 136, 0); font-style: italic; ">54 </span> <span style="color: rgb(0, 0, 128); font-weight: bold; ">if</span> <span style="color: rgb(0, 0, 0); ">__name__</span> <span style="color: rgb(0, 0, 0); ">==</span> <span style="color: rgb(0, 0, 255); ">&#39;__main__&#39;</span><span style="color: rgb(0, 0, 0); ">:</span><br><span style="color: rgb(248, 16, 176); ">55 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">start</span> <span style="color: rgb(0, 0, 0); ">=</span> <span style="color: rgb(0, 0, 0); ">time</span><span style="color: rgb(0, 0, 0); ">.</span><span style="color: rgb(0, 0, 0); ">clock</span>()<br><span style="color: rgb(0, 136, 0); font-style: italic; ">56 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">main</span>()<br><span style="color: rgb(0, 136, 0); font-style: italic; ">57 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0); ">end</span> <span style="color: rgb(0, 0, 0); ">=</span> <span style="color: rgb(0, 0, 0); ">time</span><span style="color: rgb(0, 0, 0); ">.</span><span style="color: rgb(0, 0, 0); ">clock</span>()<br><span style="color: rgb(0, 136, 0); font-style: italic; ">58 </span> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold; ">print</span> <span style="color: rgb(0, 0, 255); ">&#39;use time :</span><span style="color: rgb(0, 0, 255); ">%f</span><span style="color: rgb(0, 0, 255); ">&#39;</span> <span style="color: rgb(0, 0, 0); ">%</span> (<span style="color: rgb(0, 0, 0); ">end</span><span style="color: rgb(0, 0, 0); ">-</span><span style="color: rgb(0, 0, 0); ">start</span>)<br></div>

  
