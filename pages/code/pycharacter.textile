---
layout: default
title: Pinyin to Character
---
h1. Pinyin to Character

<p>用户输入拼音对拼音进行识别，一向是输入法来做的事情。在这里调用QQ的云端输入法来对输入的拼音进行识别，从而具备很高的匹配率。</p>
<p>代码如下，详见 &nbsp;<a href="https://github.com/xddaijun/somecode/blob/master/pycharacter/getwords.py">https://github.com/xddaijun/somecode/blob/master/pycharacter/getwords.py</a></p>
<div style="background:#fdfdfd;color:black;"></div>
     <div class="source" style="font-family: '[object HTMLOptionElement]', 'Courier New'; color: rgb(246, 243, 232); background-color: rgb(36, 36, 36); "> <span style="color: rgb(153, 150, 139); font-style: italic; "># -*- coding: utf-8 -*-</span><br> <span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;&quot;"</span><br> 
     
     
     
     <span style="color: rgb(149, 228, 84); font-style: italic; ">Created on Sat Jun 25 16:37:12 2011</span><br> <br> <span style="color: rgb(149, 228, 84); font-style: italic; ">@author: mark</span><br> <span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;&quot;"</span><br> <br> <span style="color: rgb(246, 243, 232); ">from</span> <span style="color: rgb(246, 243, 232); ">urllib</span> <span style="color: rgb(246, 243, 232); ">import</span> <span style="color: rgb(246, 243, 232); ">urlopen</span><br> <span style="color: rgb(246, 243, 232); ">import</span> <span style="color: rgb(246, 243, 232); ">simplejson</span> <span style="color: rgb(246, 243, 232); ">as</span> <span style="color: rgb(246, 243, 232); ">json</span><br> <span style="color: rgb(246, 243, 232); ">import</span> <span style="color: rgb(246, 243, 232); ">time</span><br> <span style="color: rgb(246, 243, 232); ">import</span> <span style="color: rgb(246, 243, 232); ">re</span><br> <br> <br> <span style="color: rgb(138, 198, 242); ">def</span> <span style="color: rgb(202, 230, 130); ">getQQWords</span>(<span style="color: rgb(246, 243, 232); ">preword</span><span style="color: rgb(246, 243, 232); ">,</span><span style="color: rgb(246, 243, 232); ">pys</span><span style="color: rgb(246, 243, 232); ">,</span><span style="color: rgb(246, 243, 232); ">curNum</span><span style="color: rgb(246, 243, 232); ">):</span> <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">global</span> <span style="color: rgb(246, 243, 232); ">wordsSet</span>&nbsp;&nbsp;&nbsp; <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">if</span>(<span style="color: rgb(246, 243, 232); ">len</span>(<span style="color: rgb(246, 243, 232); ">pys</span>)<span style="color: rgb(246, 243, 232); ">&lt;</span><span style="color: rgb(229, 120, 109); ">1</span> <span style="color: rgb(246, 243, 232); ">and</span> <span style="color: rgb(246, 243, 232); ">preword</span> <span style="color: rgb(246, 243, 232); ">not</span> <span style="color: rgb(246, 243, 232); ">in</span> <span style="color: rgb(246, 243, 232); ">wordsSet</span><span style="color: rgb(246, 243, 232); ">):</span>&nbsp;&nbsp;&nbsp;&nbsp; <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">wordsSet</span><span style="color: rgb(246, 243, 232); ">.</span><span style="color: rgb(246, 243, 232); ">append</span>(<span style="color: rgb(246, 243, 232); ">preword</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">return</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">if</span> <span style="color: rgb(246, 243, 232); ">curNum</span><span style="color: rgb(246, 243, 232); ">&gt;</span><span style="color: rgb(229, 120, 109); ">1</span><span style="color: rgb(246, 243, 232); ">:</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">nextNum</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">curNum</span><span style="color: rgb(246, 243, 232); ">-</span><span style="color: rgb(229, 120, 109); ">1</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">else</span><span style="color: rgb(246, 243, 232); ">:</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">nextNum</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(229, 120, 109); ">1</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">pylen</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">len</span>(<span style="color: rgb(246, 243, 232); ">pys</span>)<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">sout</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">json</span><span style="color: rgb(246, 243, 232); ">.</span><span style="color: rgb(246, 243, 232); ">load</span>(<span style="color: rgb(246, 243, 232); ">urlopen</span>(<span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;http://ime.qq.com/fcgi-bin/getword?q=</span><span style="color: rgb(149, 228, 84); font-style: italic; ">%s</span><span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;</span> <span style="color: rgb(246, 243, 232); ">%</span> <span style="color: rgb(246, 243, 232); ">pys</span>))<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(229, 120, 109); ">0</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">while</span>(<span style="color: rgb(246, 243, 232); ">pylen</span><span style="color: rgb(246, 243, 232); ">&gt;=</span><span style="color: rgb(229, 120, 109); ">1</span> <span style="color: rgb(246, 243, 232); ">and</span> <span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">&lt;</span><span style="color: rgb(246, 243, 232); ">curNum</span><span style="color: rgb(246, 243, 232); ">):</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">getQQWords</span>(<span style="color: rgb(246, 243, 232); ">preword</span><span style="color: rgb(246, 243, 232); ">+</span><span style="color: rgb(246, 243, 232); ">sout</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(149, 228, 84); font-style: italic; ">&#39;rs&#39;</span><span style="color: rgb(246, 243, 232); ">][</span><span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">],</span><span style="color: rgb(246, 243, 232); ">pys</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(246, 243, 232); ">int</span>(<span style="color: rgb(246, 243, 232); ">sout</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(149, 228, 84); font-style: italic; ">&#39;rsn&#39;</span><span style="color: rgb(246, 243, 232); ">][</span><span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">]):],</span><span style="color: rgb(246, 243, 232); ">nextNum</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">+</span><span style="color: rgb(229, 120, 109); ">1</span><br> <br> <span style="color: rgb(138, 198, 242); ">def</span> <span style="color: rgb(202, 230, 130); ">parsePY</span>(<span style="color: rgb(246, 243, 232); ">inputStr</span><span style="color: rgb(246, 243, 232); ">):</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">global</span> <span style="color: rgb(246, 243, 232); ">wordsSet</span>&nbsp;&nbsp;&nbsp; <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">outwords</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">[]</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">match</span> <span style="color: rgb(246, 243, 232); ">=</span> <span style="color: rgb(246, 243, 232); ">re</span><span style="color: rgb(246, 243, 232); ">.</span><span style="color: rgb(246, 243, 232); ">search</span>(<span style="color: rgb(149, 228, 84); font-style: italic; ">r&#39;^[a-zA-Z</span><span style="color: rgb(149, 228, 84); font-style: italic; ">\&#39;</span><span style="color: rgb(149, 228, 84); font-style: italic; ">\s]+$&#39;</span><span style="color: rgb(246, 243, 232); ">,</span> <span style="color: rgb(246, 243, 232); ">inputStr</span>)<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">if</span> <span style="color: rgb(246, 243, 232); ">match</span><span style="color: rgb(246, 243, 232); ">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">matches</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">re</span><span style="color: rgb(246, 243, 232); ">.</span><span style="color: rgb(246, 243, 232); ">split</span>(<span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;\s&quot;</span><span style="color: rgb(246, 243, 232); ">,</span><span style="color: rgb(246, 243, 232); ">inputStr</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(229, 120, 109); ">0</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">if</span> <span style="color: rgb(246, 243, 232); ">len</span>(<span style="color: rgb(246, 243, 232); ">matches</span>)<span style="color: rgb(246, 243, 232); ">&gt;</span><span style="color: rgb(229, 120, 109); ">1</span><span style="color: rgb(246, 243, 232); ">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">outwords</span><span style="color: rgb(246, 243, 232); ">.</span><span style="color: rgb(246, 243, 232); ">append</span>(<span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;&quot;</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">while</span> <span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">&lt;</span><span style="color: rgb(246, 243, 232); ">len</span>(<span style="color: rgb(246, 243, 232); ">matches</span><span style="color: rgb(246, 243, 232); ">):</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">wordsSet</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">[]</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">getQQWords</span>(<span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;&quot;</span><span style="color: rgb(246, 243, 232); ">,</span><span style="color: rgb(246, 243, 232); ">matches</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">],</span><span style="color: rgb(229, 120, 109); ">1</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">outwords</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(229, 120, 109); ">0</span><span style="color: rgb(246, 243, 232); ">]</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">outwords</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(229, 120, 109); ">0</span><span style="color: rgb(246, 243, 232); ">]</span><span style="color: rgb(246, 243, 232); ">+</span><span style="color: rgb(246, 243, 232); ">wordsSet</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(229, 120, 109); ">0</span><span style="color: rgb(246, 243, 232); ">]</span><span style="color: rgb(246, 243, 232); ">+</span><span style="color: rgb(149, 228, 84); font-style: italic; ">&quot; &quot;</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">+</span><span style="color: rgb(229, 120, 109); ">1</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">else</span><span style="color: rgb(246, 243, 232); ">:</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">wordsSet</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">[]</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">getQQWords</span>(<span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;&quot;</span><span style="color: rgb(246, 243, 232); ">,</span><span style="color: rgb(246, 243, 232); ">matches</span><span style="color: rgb(246, 243, 232); ">[</span><span style="color: rgb(246, 243, 232); ">ix</span><span style="color: rgb(246, 243, 232); ">],</span><span style="color: rgb(229, 120, 109); ">3</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">outwords</span><span style="color: rgb(246, 243, 232); ">=</span><span style="color: rgb(246, 243, 232); ">wordsSet</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">return</span> <span style="color: rgb(246, 243, 232); ">outwords</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br> <br> <span style="color: rgb(138, 198, 242); ">def</span> <span style="color: rgb(202, 230, 130); ">main</span><span style="color: rgb(246, 243, 232); ">():</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">for</span> <span style="color: rgb(246, 243, 232); ">w</span> <span style="color: rgb(246, 243, 232); ">in</span> <span style="color: rgb(246, 243, 232); ">parsePY</span>(<span style="color: rgb(149, 228, 84); font-style: italic; ">&quot;woshiyigerxi&#39;anshi&quot;</span><span style="color: rgb(246, 243, 232); ">):</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">print</span> <span style="color: rgb(246, 243, 232); ">w</span><br> <br> <span style="color: rgb(138, 198, 242); ">if</span> <span style="color: rgb(246, 243, 232); ">__name__</span> <span style="color: rgb(246, 243, 232); ">==</span> <span style="color: rgb(149, 228, 84); font-style: italic; ">&#39;__main__&#39;</span><span style="color: rgb(246, 243, 232); ">:</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">start</span> <span style="color: rgb(246, 243, 232); ">=</span> <span style="color: rgb(246, 243, 232); ">time</span><span style="color: rgb(246, 243, 232); ">.</span><span style="color: rgb(246, 243, 232); ">clock</span>()<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">main</span>()<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(246, 243, 232); ">end</span> <span style="color: rgb(246, 243, 232); ">=</span> <span style="color: rgb(246, 243, 232); ">time</span><span style="color: rgb(246, 243, 232); ">.</span><span style="color: rgb(246, 243, 232); ">clock</span>()<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(138, 198, 242); ">print</span> <span style="color: rgb(149, 228, 84); font-style: italic; ">&#39;use time :</span><span style="color: rgb(149, 228, 84); font-style: italic; ">%f</span><span style="color: rgb(149, 228, 84); font-style: italic; ">&#39;</span> <span style="color: rgb(246, 243, 232); ">%</span> (<span style="color: rgb(246, 243, 232); ">end</span><span style="color: rgb(246, 243, 232); ">-</span><span style="color: rgb(246, 243, 232); ">start</span>)<br></div>
